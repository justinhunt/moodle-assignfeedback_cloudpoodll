define(["jquery","core/log","core/str","core/ajax","core/notification","core/modal_factory","core/modal_events"],(function($,log,str,Ajax,notification,ModalFactory,ModalEvents){return log.debug("Fetch Submission: initialising"),{controls:{},overwrite:"OVERWRITE",overwritefetchedsubmission:"Overwrite the submitted text?",overwritewarning:"WARNING: Overwrite",init:function(){this.register_controls(),this.init_strings(),this.register_events()},init_strings:function(){var that=this;str.get_string("overwrite","assignfeedback_cloudpoodll").done((function(s){that.overwrite=s})),str.get_string("overwritefetchedsubmission","assignfeedback_cloudpoodll").done((function(s){that.overwritefetchedsubmission=s})),str.get_string("overwritewarning","assignfeedback_cloudpoodll").done((function(s){that.overwritewarning=s}))},register_controls:function(){this.controls.fetchsubmissionbutton=$(".fetchsubmissiontrigger")},register_events:function(){var that=this;that.controls.fetchsubmissionbutton.click((function(e){var targetselector=$(this).data("target");return $(targetselector).val().length>0?ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:that.overwritewarning,body:that.overwritefetchedsubmission}).then((function(themodal){return themodal.setSaveButtonText(that.overwrite),themodal.getRoot().on(ModalEvents.save,(function(e){that.do_fetch(targetselector)})),themodal.show(),themodal})):that.do_fetch(targetselector),!1}))},do_fetch:function(targetselector){var submittedtext="",cp_transcript=$(".assignsubmission_cloudpoodll_transcript-text");if(cp_transcript.length>0)submittedtext=cp_transcript.text();else{var ot_summary=$(".assignsubmission_onlinetext .plugincontentsummary");if(ot_summary.length>0){var fulltextclass=ot_summary.attr("class").split(" ").pop().replace("summary","full"),ot_transcript=$("."+fulltextclass);ot_transcript.length>0&&(submittedtext=ot_transcript.text())}}""!==submittedtext&&$(targetselector).val(submittedtext)}}}));

//# sourceMappingURL=fetchsubmission.min.js.map